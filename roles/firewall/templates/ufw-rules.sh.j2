#!/bin/bash
# UFW Rules Configuration Script
# Generated by Ansible

set -e

{% for rule in ufw_rules | default([]) %}
# {{ rule.comment | default('UFW rule') }}
ufw {{ rule.rule }}{% if rule.port is defined %} {{ rule.port }}{% endif %}{% if rule.proto is defined %}/{{ rule.proto }}{% endif %}{% if rule.from_ip is defined %} from {{ rule.from_ip }}{% endif %}{% if rule.to_ip is defined %} to {{ rule.to_ip }}{% endif %}{% if rule.src is defined %} from {{ rule.src }}{% endif %}{% if rule.dest is defined %} to {{ rule.dest }}{% endif %}{% if rule.comment is defined %} comment '{{ rule.comment }}'{% endif %}

{% endfor %}

{% for rule in ufw_rate_limit_rules | default([]) %}
# {{ rule.comment | default('UFW rate limit rule') }}
ufw limit{% if rule.port is defined %} {{ rule.port }}{% endif %}{% if rule.proto is defined %}/{{ rule.proto }}{% endif %}{% if rule.from_ip is defined %} from {{ rule.from_ip }}{% endif %}{% if rule.to_ip is defined %} to {{ rule.to_ip }}{% endif %}{% if rule.src is defined %} from {{ rule.src }}{% endif %}{% if rule.dest is defined %} to {{ rule.dest }}{% endif %}{% if rule.comment is defined %} comment '{{ rule.comment }}'{% endif %}

{% endfor %}

{% for rule in ufw_ip_rules | default([]) %}
# {{ rule.comment | default('UFW IP rule') }}
ufw {{ rule.rule }}{% if rule.port is defined %} {{ rule.port }}{% endif %}{% if rule.proto is defined %}/{{ rule.proto }}{% endif %}{% if rule.from_ip is defined %} from {{ rule.from_ip }}{% endif %}{% if rule.to_ip is defined %} to {{ rule.to_ip }}{% endif %}{% if rule.src is defined %} from {{ rule.src }}{% endif %}{% if rule.dest is defined %} to {{ rule.dest }}{% endif %}{% if rule.comment is defined %} comment '{{ rule.comment }}'{% endif %}

{% endfor %}

{% for rule in ufw_application_rules | default([]) %}
# {{ rule.comment | default('UFW application rule') }}
ufw {{ rule.rule }} {{ rule.name }}{% if rule.comment is defined %} comment '{{ rule.comment }}'{% endif %}

{% endfor %}