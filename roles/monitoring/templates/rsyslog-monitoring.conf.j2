# RSyslog configuration for monitoring
# Generated by Ansible

# Custom monitoring logs
if $programname == 'system-monitor' then /var/log/monitoring/system-monitor.log
if $programname == 'security-monitor' then /var/log/monitoring/security-monitor.log
if $programname == 'service-monitor' then /var/log/monitoring/service-monitor.log
if $programname == 'disk-monitor' then /var/log/monitoring/disk-monitor.log
if $programname == 'network-monitor' then /var/log/monitoring/network-monitor.log
if $programname == 'matrix-monitor' then /var/log/monitoring/matrix-monitor.log

# Stop further processing of these messages
if $programname == 'system-monitor' then stop
if $programname == 'security-monitor' then stop
if $programname == 'service-monitor' then stop
if $programname == 'disk-monitor' then stop
if $programname == 'network-monitor' then stop
if $programname == 'matrix-monitor' then stop

# High priority alerts
if $msg contains 'CRITICAL' then @@{{ monitoring_syslog_server | default('127.0.0.1:514') }}
if $msg contains 'ALERT' then @@{{ monitoring_syslog_server | default('127.0.0.1:514') }}

# Matrix-specific error logging
if $programname == 'matrix-synapse' and $msg contains 'ERROR' then /var/log/monitoring/matrix-errors.log

# SSH attack monitoring
if $programname == 'sshd' and $msg contains 'Failed password' then /var/log/monitoring/ssh-attacks.log
if $programname == 'sshd' and $msg contains 'Invalid user' then /var/log/monitoring/ssh-attacks.log

# Fail2ban notifications
if $programname == 'fail2ban' then /var/log/monitoring/fail2ban.log